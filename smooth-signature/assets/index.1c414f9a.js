import{o as v,c as g,a as l,w as x,v as C,u as D,b as p,V as W,d as _}from"./vendor.009b77e5.js";const R=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerpolicy&&(e.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?e.credentials="include":n.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function t(n){if(n.ep)return;n.ep=!0;const e=s(n);fetch(n.href,e)}};R();function f(r){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f(r)}function F(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function S(r,a){for(var s=0;s<a.length;s++){var t=a[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,N(t.key),t)}}function k(r,a,s){return a&&S(r.prototype,a),s&&S(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}function N(r){var a=M(r,"string");return f(a)=="symbol"?a:a+""}function M(r,a){if(f(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var t=s.call(r,a||"default");if(f(t)!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}var U=/Android|iPhone|iPad|Mobile/i.test(navigator.userAgent),w=function(){function r(a,s){var t=this;F(this,r),this.canvas={},this.ctx={},this.width=320,this.height=200,this.scale=window.devicePixelRatio||1,this.color="black",this.bgColor="",this.canDraw=!1,this.openSmooth=!0,this.minWidth=2,this.maxWidth=6,this.minSpeed=1.5,this.maxWidthDiffRate=20,this.points=[],this.undoList=[],this.redoList=[],this.onStart=function(){},this.onEnd=function(){},this.addListener=function(){t.removeListener(),t.canvas.style.touchAction="none",U&&("ontouchstart"in window||navigator.maxTouchPoints)?(t.canvas.addEventListener("touchstart",t.onDrawStart,{passive:!1}),t.canvas.addEventListener("touchmove",t.onDrawMove,{passive:!1}),document.addEventListener("touchcancel",t.onDrawEnd,{passive:!1}),document.addEventListener("touchend",t.onDrawEnd,{passive:!1})):(t.canvas.addEventListener("mousedown",t.onDrawStart),t.canvas.addEventListener("mousemove",t.onDrawMove),document.addEventListener("mouseup",t.onDrawEnd))},this.removeListener=function(){t.canvas.style.touchAction="auto",t.canvas.removeEventListener("touchstart",t.onDrawStart),t.canvas.removeEventListener("touchmove",t.onDrawMove),document.removeEventListener("touchend",t.onDrawEnd),document.removeEventListener("touchcancel",t.onDrawEnd),t.canvas.removeEventListener("mousedown",t.onDrawStart),t.canvas.removeEventListener("mousemove",t.onDrawMove),document.removeEventListener("mouseup",t.onDrawEnd)},this.onDrawStart=function(n){n.preventDefault(),t.canDraw=!0,t.initPoint(n),t.onStart&&t.onStart(n)},this.onDrawMove=function(n){if(n.preventDefault(),!!t.canDraw&&(t.initPoint(n),!(t.points.length<2))){var e=t.points.slice(-1)[0],i=t.points.slice(-2,-1)[0];window.requestAnimationFrame?window.requestAnimationFrame(function(){return t.onDraw(i,e)}):t.onDraw(i,e)}},this.onDraw=function(n,e){t.ctx.strokeStyle=e.color||t.color,t.openSmooth?t.drawSmoothLine(n,e):t.drawNoSmoothLine(n,e)},this.onDrawEnd=function(n){!t.canDraw||(t.undoList.push(t.points),t.redoList=[],t.canDraw=!1,t.points=[],t.onEnd&&t.onEnd(n))},this.getLineWidth=function(n){var e=t.minSpeed>10?10:t.minSpeed<1?1:t.minSpeed,i=(t.maxWidth-t.minWidth)*n/e,o=Math.max(t.maxWidth-i,t.minWidth);return Math.min(o,t.maxWidth)},this.getRadianData=function(n,e,i,o){var d=i-n,h=o-e;if(d===0)return{val:0,pos:-1};if(h===0)return{val:0,pos:1};var c=Math.abs(Math.atan(h/d));return i>n&&o<e||i<n&&o>e?{val:c,pos:1}:{val:c,pos:-1}},this.getRadianPoints=function(n,e,i,o){if(n.val===0)return n.pos===1?[{x:e,y:i+o},{x:e,y:i-o}]:[{y:i,x:e+o},{y:i,x:e-o}];var d=Math.sin(n.val)*o,h=Math.cos(n.val)*o;return n.pos===1?[{x:e+d,y:i+h},{x:e-d,y:i-h}]:[{x:e+d,y:i-h},{x:e-d,y:i+h}]},this.initPoint=function(n){var e=Date.now(),i=t.points.slice(-1)[0];if(!(i&&i.t===e)){var o=t.canvas.getBoundingClientRect(),d=n.touches&&n.touches[0]||n,h=d.clientX-o.left,c=d.clientY-o.top;if(!(i&&i.x===h&&i.y===c)){var u={x:h,y:c,t:e,color:t.color};if(t.openSmooth&&i){var y=t.points.slice(-2,-1)[0];if(u.distance=Math.sqrt(Math.pow(u.x-i.x,2)+Math.pow(u.y-i.y,2)),u.speed=u.distance/(u.t-i.t||.1),u.lineWidth=t.getLineWidth(u.speed),y&&y.lineWidth&&i.lineWidth){var b=(u.lineWidth-i.lineWidth)/i.lineWidth,m=t.maxWidthDiffRate/100;if(m=m>1?1:m<.01?.01:m,Math.abs(b)>m){var L=b>0?m:-m;u.lineWidth=i.lineWidth*(1+L)}}}t.points.push(u)}}},this.drawSmoothLine=function(n,e){var i=e.x-n.x,o=e.y-n.y;if(Math.abs(i)+Math.abs(o)<=t.scale?(e.lastX1=e.lastX2=n.x+i*.5,e.lastY1=e.lastY2=n.y+o*.5):(e.lastX1=n.x+i*.3,e.lastY1=n.y+o*.3,e.lastX2=n.x+i*.7,e.lastY2=n.y+o*.7),e.perLineWidth=(n.lineWidth+e.lineWidth)/2,typeof n.lastX1=="number"){if(t.drawCurveLine(n.lastX2,n.lastY2,n.x,n.y,e.lastX1,e.lastY1,e.perLineWidth),n.isFirstPoint||n.lastX1===n.lastX2&&n.lastY1===n.lastY2)return;var d=t.getRadianData(n.lastX1,n.lastY1,n.lastX2,n.lastY2),h=t.getRadianPoints(d,n.lastX1,n.lastY1,n.perLineWidth/2),c=t.getRadianPoints(d,n.lastX2,n.lastY2,e.perLineWidth/2);t.drawTrapezoid(h[0],c[0],c[1],h[1],e.color)}else e.isFirstPoint=!0},this.drawNoSmoothLine=function(n,e){e.lastX=n.x+(e.x-n.x)*.5,e.lastY=n.y+(e.y-n.y)*.5,typeof n.lastX=="number"&&t.drawCurveLine(n.lastX,n.lastY,n.x,n.y,e.lastX,e.lastY,t.maxWidth)},this.drawCurveLine=function(n,e,i,o,d,h,c){t.ctx.lineWidth=Number(c.toFixed(1)),t.ctx.beginPath(),t.ctx.moveTo(Number(n.toFixed(1)),Number(e.toFixed(1))),t.ctx.quadraticCurveTo(Number(i.toFixed(1)),Number(o.toFixed(1)),Number(d.toFixed(1)),Number(h.toFixed(1))),t.ctx.stroke()},this.drawTrapezoid=function(n,e,i,o,d){t.ctx.beginPath(),t.ctx.moveTo(Number(n.x.toFixed(1)),Number(n.y.toFixed(1))),t.ctx.lineTo(Number(e.x.toFixed(1)),Number(e.y.toFixed(1))),t.ctx.lineTo(Number(i.x.toFixed(1)),Number(i.y.toFixed(1))),t.ctx.lineTo(Number(o.x.toFixed(1)),Number(o.y.toFixed(1))),t.ctx.fillStyle=d||t.color,t.ctx.fill()},this.drawBgColor=function(){!t.bgColor||(t.ctx.fillStyle=t.bgColor,t.ctx.fillRect(0,0,t.width,t.height))},this.drawByImageUrl=function(n){var e=new Image;e.onload=function(){t.ctx.clearRect(0,0,t.width,t.height),t.ctx.drawImage(e,0,0,t.width,t.height)},e.crossOrigin="anonymous",e.src=n},this.clear=function(){t.ctx.clearRect(0,0,t.width,t.height),t.drawBgColor(),t.undoList=[],t.redoList=[]},this.undo=function(){if(!!t.undoList.length){var n=t.undoList.pop();n&&t.redoList.unshift(n),t.ctx.clearRect(0,0,t.width,t.height),t.drawBgColor(),t.undoList.forEach(function(e){e.forEach(function(i,o){o!==0&&t.onDraw(e[o-1],i)})})}},this.redo=function(){if(!!t.redoList.length){var n=t.redoList.shift();n&&t.undoList.push(n),t.ctx.clearRect(0,0,t.width,t.height),t.drawBgColor(),t.undoList.forEach(function(e){e.forEach(function(i,o){o!==0&&t.onDraw(e[o-1],i)})})}},this.toDataURL=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(t.canvas.width===t.width)return t.canvas.toDataURL(n,e);var i=document.createElement("canvas");i.width=t.width,i.height=t.height;var o=i.getContext("2d");return o.drawImage(t.canvas,0,0,i.width,i.height),i.toDataURL(n,e)},this.getPNG=function(){return t.toDataURL()},this.getJPG=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.8;return t.toDataURL("image/jpeg",n)},this.isEmpty=function(){var n=document.createElement("canvas"),e=n.getContext("2d");return n.width=t.canvas.width,n.height=t.canvas.height,t.bgColor?(e.fillStyle=t.bgColor,e.fillRect(0,0,n.width,n.height)):t.scale!==1&&e.scale(t.scale,t.scale),n.toDataURL()===t.canvas.toDataURL()},this.getRotateCanvas=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:90;n>0?n=n>90?180:90:n=n<-90?180:-90;var e=document.createElement("canvas"),i=t.width,o=t.height;n===180?(e.width=i,e.height=o):(e.width=o,e.height=i);var d=e.getContext("2d");return d.rotate(n*Math.PI/180),n===90?d.drawImage(t.canvas,0,-o,i,o):n===-90?d.drawImage(t.canvas,-i,0,i,o):n===180&&d.drawImage(t.canvas,-i,-o,i,o),e},this.init(a,s)}return k(r,[{key:"init",value:function(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};!s||(this.canvas=s,this.ctx=s.getContext("2d"),this.width=t.width||s.clientWidth||this.width,this.height=t.height||s.clientHeight||this.height,this.scale=t.scale||this.scale,this.color=t.color||this.color,this.bgColor=t.bgColor||this.bgColor,this.openSmooth=t.openSmooth===void 0?this.openSmooth:!!t.openSmooth,this.minWidth=t.minWidth||this.minWidth,this.maxWidth=t.maxWidth||this.maxWidth,this.minSpeed=t.minSpeed||this.minSpeed,this.maxWidthDiffRate=t.maxWidthDiffRate||this.maxWidthDiffRate,this.onStart=t.onStart,this.onEnd=t.onEnd,this.scale>0&&(this.canvas.height=this.height*this.scale,this.canvas.width=this.width*this.scale,this.scale!==1&&(this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.ctx.scale(this.scale,this.scale))),this.ctx.lineCap="round",this.drawBgColor(),this.addListener())}}]),r}();var E=(r,a)=>{for(const[s,t]of a)r[s]=t;return r};const X={name:"pcDemo",data(){return{openSmooth:!0}},mounted(){this.init()},methods:{init(){const r=document.getElementById("canvas"),a={width:Math.min(window.innerWidth,1e3),height:600,minWidth:4,maxWidth:12,bgColor:"#f6f6f6"};this.signature=new w(r,a)},handleClear(){this.signature.clear()},handleUndo(){this.signature.undo()},handleRedo(){this.signature.redo()},handleColor(){this.signature.color="#"+Math.random().toString(16).slice(-6)},handlePreview(){if(this.signature.isEmpty()){alert("isEmpty");return}const a=this.signature.getPNG();window.previewImage(a)}}},I={class:"pcDemo"},Y={class:"actions"},B=l("div",{class:"tip"},"\u4F7F\u7528\u624B\u673A\u7AEF\u624B\u5199\u66F4\u65B9\u4FBF",-1),T=l("canvas",{id:"canvas"},null,-1);function A(r,a,s,t,n,e){return v(),g("div",I,[l("div",Y,[l("button",{onClick:a[0]||(a[0]=(...i)=>e.handleClear&&e.handleClear(...i))},"Clear"),l("button",{onClick:a[1]||(a[1]=(...i)=>e.handleUndo&&e.handleUndo(...i))},"Undo"),l("button",{onClick:a[2]||(a[2]=(...i)=>e.handleRedo&&e.handleRedo(...i))},"Redo"),l("button",{onClick:a[3]||(a[3]=(...i)=>e.handlePreview&&e.handlePreview(...i))},"View PNG"),l("button",{onClick:a[4]||(a[4]=(...i)=>e.handleColor&&e.handleColor(...i))},"Change Color")]),B,T])}var O=E(X,[["render",A]]);const q={name:"mbDemo",data(){return{showFull:!0}},mounted(){this.initSignature1(),this.initSignture2()},methods:{initSignature1(){const r=document.getElementById("canvas1"),a={width:window.innerWidth-10,height:200,minWidth:2,maxWidth:6,bgColor:"#f6f6f6"};this.signature1=new w(r,a)},initSignture2(){const r=document.getElementById("canvas2"),a={width:window.innerWidth-100,height:window.innerHeight-50,minWidth:3,maxWidth:10,bgColor:"#f6f6f6"};this.signature2=new w(r,a)},handleClear1(){this.signature1.clear()},handleClear2(){this.signature2.clear()},handleUndo1(){this.signature1.undo()},handleUndo2(){this.signature2.undo()},handleRedo1(){this.signature1.redo()},handleRedo2(){this.signature2.redo()},handleFull(){this.showFull=!this.showFull},handlePreview1(){if(this.signature1.isEmpty()){alert("isEmpty");return}const a=this.signature1.getPNG();window.previewImage(a)},handlePreview2(){if(this.signature2.isEmpty()){alert("isEmpty");return}const s=this.signature2.getRotateCanvas(-90).toDataURL();window.previewImage(s,90)},handleColor1(){this.signature1.color=this.getRandomColor()},handleColor2(){this.signature2.color=this.getRandomColor()},getRandomColor(){return"#"+Math.random().toString(16).slice(-6)}}},G={class:"mbDemo"},P={class:"wrap1"},V=l("canvas",{class:"canvas1",id:"canvas1"},null,-1),j={class:"actions"},z={class:"wrap2"},H={class:"actionsWrap"},K={class:"actions"},J=l("canvas",{class:"canvas",id:"canvas2"},null,-1);function Q(r,a,s,t,n,e){return v(),g("div",G,[x(l("div",P,[V,l("div",j,[l("button",{onClick:a[0]||(a[0]=(...i)=>e.handleClear1&&e.handleClear1(...i))},"Clear"),l("button",{onClick:a[1]||(a[1]=(...i)=>e.handleUndo1&&e.handleUndo1(...i))},"Undo"),l("button",{onClick:a[2]||(a[2]=(...i)=>e.handleRedo1&&e.handleRedo1(...i))},"Redo"),l("button",{onClick:a[3]||(a[3]=(...i)=>e.handlePreview1&&e.handlePreview1(...i))},"View PNG"),l("button",{onClick:a[4]||(a[4]=(...i)=>e.handleColor1&&e.handleColor1(...i))},"Change Color"),l("button",{onClick:a[5]||(a[5]=(...i)=>e.handleFull&&e.handleFull(...i))},"Full Screen")])],512),[[C,!n.showFull]]),x(l("div",z,[l("div",H,[l("div",K,[l("button",{onClick:a[6]||(a[6]=(...i)=>e.handleClear2&&e.handleClear2(...i))},"Clear"),l("button",{onClick:a[7]||(a[7]=(...i)=>e.handleUndo2&&e.handleUndo2(...i))},"Undo"),l("button",{onClick:a[8]||(a[8]=(...i)=>e.handleRedo2&&e.handleRedo2(...i))},"Redo"),l("button",{onClick:a[9]||(a[9]=(...i)=>e.handlePreview2&&e.handlePreview2(...i))},"View PNG"),l("button",{onClick:a[10]||(a[10]=(...i)=>e.handleColor2&&e.handleColor2(...i))},"Change Color"),l("button",{onClick:a[11]||(a[11]=(...i)=>e.handleFull&&e.handleFull(...i))},"Close Full Screen")])]),J],512),[[C,n.showFull]])])}var Z=E(q,[["render",Q]]);const $={setup(r){const a=/Android|iPhone|iPad|Mobile/i.test(window.navigator.userAgent);return(s,t)=>(v(),g("div",null,[D(a)?(v(),p(Z,{key:0})):(v(),p(O,{key:1}))]))}};window.previewImage=function(r,a){const s=document.createElement("img");s.src=r;const t=new W(s,{title:0,navbar:0,toolbar:{zoomIn:1,zoomOut:1,oneToOne:1,reset:1,rotateLeft:1,rotateRight:1,flipHorizontal:1,flipVertical:1},viewed(){a&&this.viewer.zoomTo(.8).rotateTo(a)}});s.onload=function(){t.show()}};_($).mount("#app");
